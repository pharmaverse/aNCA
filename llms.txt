# automated Non-Compartmental Analysis (aNCA)

![aNCA logo](reference/figures/aNCA_logo.png)

  

> Our aim is to develop and share an open-source R Shiny application for
> performing Non-Compartmental Analysis (NCA) on clinical and
> non-clinical datasets worldwide and across pharmaceutical companies.  

## Description

This application enables users to upload their datasets and perform
Non-Compartment Analysis (NCA) on both pre-clinical and clinical
datasets, with the results being easily visualizable. Designed with
user-friendliness in mind, this app aims to make NCA accessible and
straightforward for all scientists. Among the features it currently
possess, the App can:

- **Customize half life calculation**: Either by rule settings
  definitions or performing manual in-plot adjustments
- **Define AUC intervals of interest**: Providing by default last and
  to-infinite calculations
- **Visualize data and results** with interactive boxplots, summary
  statistic tables and scatter plots
- **Produce PP and ADPP** dataset formats of the resulting parameters
- **Save your analysis settings** and reupload them later to keep on
  analysing!

## Installation

### Via pak (recommended)

We recommend using [pak](https://github.com/r-lib/pak) for package
installation, along with all system dependencies. If you do not have
`pak` available, you will need to set it up first:

``` r
install.packages("pak")
```

then you can install [aNCA](https://pharmaverse.github.io/aNCA/) by
running:

``` r
pak::pak("pharmaverse/aNCA")
```

in your R console.

### Via cloning the repository (for contributors)

Alternatively, you can set up the package by cloning the repository
through your terminal/shell:

``` bash
git clone https://github.com/pharmaverse/aNCA.git
```

and then loading it directly using
[devtools](https://github.com/r-lib/devtools) in your IDE (e.g.Â RStudio)
console:

``` r
devtools::load_all()
```

## Quick start

To run the application, simply invoke:

``` r
aNCA::run_app()
```

The testing data will be automatically loaded upon application startup.
You can provide your own dataset in the **data** tab. Here you can also
specify pre-processing filters.

In the **NCA** tab, start off by loading the pre-processed data using
*Submit* button. You will also need to choose dose number in the
*Settings*. Then, you will be able to run the NCA analysis. From there,
you can also specify different analysis options, like applying flag rule
sets and selecting slopes.

After the setup is done and analysis is performed, you are free to
explore the results in the **Outputs** tab. Application supports various
customizable plots, as well as report exporting.

For more detailed instructions, check out the [Get
Started](https://pharmaverse.github.io/aNCA/articles/aNCA.html) page.

## Contributing

### As developer

To ensure a clean codebase and smooth cooperation, please adhere to the
[contributing
guidelines](https://github.com/pharmaverse/aNCA/blob/main/CONTRIBUTING.md).

### As user

Feel free to open identified
[issues](https://github.com/pharmaverse/aNCA/issues/new/choose), to
reach out to us for questions or report in our [google
sheet](https://forms.gle/c9ULTTv1s75yRaLj7) for feedback.

## Documentation and references

- Please go to [our Website](https://pharmaverse.github.io/aNCA/) for
  further information on the **aNCA app** (still in development).
- The main package used by the App is `PKNCA`. You can find more of it
  on its [GitHub](https://github.com/humanpred/pknca)

# Package index

## All functions

- [`PKNCA_build_units_table()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_build_units_table.md)
  : Build Units Table for PKNCA

- [`PKNCA_calculate_nca()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_calculate_nca.md)
  : Calculates results for PKNCA analysis.

- [`PKNCA_create_data_object()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_create_data_object.md)
  :

  Creates a
  [`PKNCA::PKNCAdata`](http://humanpred.github.io/pknca/reference/PKNCAdata.md)
  object.

- [`PKNCA_hl_rules_exclusion()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_hl_rules_exclusion.md)
  : Exclude NCA results based on user-defined rules over the half-life
  related parameters This function applies exclusion rules to the NCA
  results based on user-defined parameters.

- [`PKNCA_impute_method_start_c1()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_impute_method_start_c1.md)
  : This function imputes the start concentration using the first
  concentration after dose

- [`PKNCA_impute_method_start_logslope()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_impute_method_start_logslope.md)
  : This function imputes the start concentration using the log slope
  method.

- [`PKNCA_update_data_object()`](https://pharmaverse.github.io/aNCA/reference/PKNCA_update_data_object.md)
  : Create a PKNCAdata Object for NCA or Slope Analysis

- [`add_f_to_pknca_results()`](https://pharmaverse.github.io/aNCA/reference/add_f_to_pknca_results.md)
  : Add bioavailability results to PKNCA results

- [`add_optional_layers()`](https://pharmaverse.github.io/aNCA/reference/add_optional_layers.md)
  : Helper function to handle optional layers

- [`add_pptx_sl_plot()`](https://pharmaverse.github.io/aNCA/reference/add_pptx_sl_plot.md)
  : Add a slide with a plot only

- [`add_pptx_sl_plottable()`](https://pharmaverse.github.io/aNCA/reference/add_pptx_sl_plottable.md)
  : Add a slide with both a plot and a table

- [`add_pptx_sl_table()`](https://pharmaverse.github.io/aNCA/reference/add_pptx_sl_table.md)
  : Add a slide with a table only

- [`add_qmd_plot()`](https://pharmaverse.github.io/aNCA/reference/add_qmd_plot.md)
  : Helper to create a Quarto code chunk for a plot

- [`add_qmd_sl_plot()`](https://pharmaverse.github.io/aNCA/reference/add_qmd_sl_plot.md)
  : Add a slide to the Quarto document with a single plot

- [`add_qmd_sl_plottabletable()`](https://pharmaverse.github.io/aNCA/reference/add_qmd_sl_plottabletable.md)
  : Add a slide to the Quarto document with a plot and two tables (side
  by side)

- [`add_qmd_table()`](https://pharmaverse.github.io/aNCA/reference/add_qmd_table.md)
  : Helper to create a Quarto code chunk for a table

- [`apply_filters()`](https://pharmaverse.github.io/aNCA/reference/apply_filters.md)
  : Apply Filters to a Dataset

- [`apply_labels()`](https://pharmaverse.github.io/aNCA/reference/apply_labels.md)
  : Apply Labels to a dataset

- [`apply_mapping()`](https://pharmaverse.github.io/aNCA/reference/apply_mapping.md)
  : Apply UI-Based Column Mapping to a Dataset

- [`calculate_f()`](https://pharmaverse.github.io/aNCA/reference/calculate_f.md)
  : Calculate bioavailability with pivoted output

- [`calculate_ratios()`](https://pharmaverse.github.io/aNCA/reference/calculate_ratios.md)
  : Calculate Ratios from PKNCA Results

- [`calculate_summary_stats()`](https://pharmaverse.github.io/aNCA/reference/calculate_summary_stats.md)
  : Calculate Summary Statistics

- [`check_slope_rule_overlap()`](https://pharmaverse.github.io/aNCA/reference/check_slope_rule_overlap.md)
  : Check overlap between existing and new slope rulesets

- [`convert_volume_units()`](https://pharmaverse.github.io/aNCA/reference/convert_volume_units.md)
  : Convert Volume Units to Match Concentration Denominator Units

- [`create_html_dose_slides()`](https://pharmaverse.github.io/aNCA/reference/create_html_dose_slides.md)
  : Render dose escalation results to HTML via Quarto

- [`create_metabfl()`](https://pharmaverse.github.io/aNCA/reference/create_metabfl.md)
  : Create METABFL Column Based on Selected Metabolites

- [`create_pptx_doc()`](https://pharmaverse.github.io/aNCA/reference/create_pptx_doc.md)
  : Create a new PowerPoint document from a template and add a title
  slide

- [`create_pptx_dose_slides()`](https://pharmaverse.github.io/aNCA/reference/create_pptx_dose_slides.md)
  : Create a PowerPoint presentation with dose escalation results,
  including main and extra figures Adds slides for summary tables, mean
  plots, line plots, and individual subject results

- [`create_qmd_doc()`](https://pharmaverse.github.io/aNCA/reference/create_qmd_doc.md)
  : Create a new Quarto presentation file with YAML header and setup
  chunk

- [`create_qmd_dose_slides()`](https://pharmaverse.github.io/aNCA/reference/create_qmd_dose_slides.md)
  : Create all slides for dose escalation results in a Quarto document

- [`create_start_impute()`](https://pharmaverse.github.io/aNCA/reference/create_start_impute.md)
  : Create C0 Impute Column

- [`detect_study_types()`](https://pharmaverse.github.io/aNCA/reference/detect_study_types.md)
  : Detect study types

- [`dose_profile_duplicates()`](https://pharmaverse.github.io/aNCA/reference/dose_profile_duplicates.md)
  : Create duplicates in concentration data with Pre-dose and Last
  Values for Dosing Cycles

- [`.apply_slope_rules()`](https://pharmaverse.github.io/aNCA/reference/dot-apply_slope_rules.md)
  : Apply Slope Rules to Update Data

- [`.compress_range()`](https://pharmaverse.github.io/aNCA/reference/dot-compress_range.md)
  : Compresses a numeric vector into the simplest possible character
  string that, when evaluated, will create the same numeric vector.

- [`.eval_range()`](https://pharmaverse.github.io/aNCA/reference/dot-eval_range.md)
  : Evaluates range notation. If provided notation is invalid, returns
  NA.

- [`.plotly_empty_plot()`](https://pharmaverse.github.io/aNCA/reference/dot-plotly_empty_plot.md)
  : Generate an Empty Plotly Object

- [`ensure_column_unit_exists()`](https://pharmaverse.github.io/aNCA/reference/ensure_column_unit_exists.md)
  : Ensure Unit Columns Exist in PKNCA Object

- [`export_cdisc()`](https://pharmaverse.github.io/aNCA/reference/export_cdisc.md)
  : Export CDISC Data

- [`filter_breaks()`](https://pharmaverse.github.io/aNCA/reference/filter_breaks.md)
  : Filter Breaks for X-Axis

- [`filter_slopes()`](https://pharmaverse.github.io/aNCA/reference/filter_slopes.md)
  : Filter dataset based on slope selections and exclusions

- [`flexible_violinboxplot()`](https://pharmaverse.github.io/aNCA/reference/flexible_violinboxplot.md)
  : Flexible Violin/Box Plot

- [`format_pkncaconc_data()`](https://pharmaverse.github.io/aNCA/reference/format_pkncaconc_data.md)
  : Create PK Concentration Dataset

- [`format_pkncadata_intervals()`](https://pharmaverse.github.io/aNCA/reference/format_pkncadata_intervals.md)
  : Create Dose Intervals Dataset

- [`format_pkncadose_data()`](https://pharmaverse.github.io/aNCA/reference/format_pkncadose_data.md)
  : Create PK Dose Dataset

- [`format_unit_string()`](https://pharmaverse.github.io/aNCA/reference/format_unit_string.md)
  : Formats a unit string if a unique unit exists

- [`g_pkcg01_lin()`](https://pharmaverse.github.io/aNCA/reference/g_pkcg01_lin.md)
  :

  Wrapper around aNCA::pkcg01() function. Calls the function with `LIN`
  scale argument.

- [`g_pkcg01_log()`](https://pharmaverse.github.io/aNCA/reference/g_pkcg01_log.md)
  :

  Wrapper around aNCA::pkcg01() function. Calls the function with `LOG`
  scale argument.

- [`g_pkcg02_lin()`](https://pharmaverse.github.io/aNCA/reference/g_pkcg02_lin.md)
  :

  Wrapper around aNCA::pkcg02() function. Calls the function with `LIN`
  scale argument.

- [`g_pkcg02_log()`](https://pharmaverse.github.io/aNCA/reference/g_pkcg02_log.md)
  :

  Wrapper around aNCA::pkcg02() function. Calls the function with `LOG`
  scale argument.

- [`general_lineplot()`](https://pharmaverse.github.io/aNCA/reference/general_lineplot.md)
  : Generate a General Line Plot for ADNCA Dataset

- [`general_meanplot()`](https://pharmaverse.github.io/aNCA/reference/general_meanplot.md)
  : Generate a Mean Concentration Plot for ADNCA Dataset

- [`generate_tooltip_text()`](https://pharmaverse.github.io/aNCA/reference/generate_tooltip_text.md)
  : Generate HTML Tooltip Text

- [`get_conversion_factor()`](https://pharmaverse.github.io/aNCA/reference/get_conversion_factor.md)
  : Transform Units

- [`get_label()`](https://pharmaverse.github.io/aNCA/reference/get_label.md)
  : Get the Label of a Heading

- [`interval_add_impute()`](https://pharmaverse.github.io/aNCA/reference/interval_add_impute.md)
  : Add specified imputation methods to the intervals in a PKNCAdata or
  data.frame object.

- [`interval_remove_impute()`](https://pharmaverse.github.io/aNCA/reference/interval_remove_impute.md)
  : Remove specified imputation from the intervals in a PKNCAdata or
  data.frame (intervals) object.

- [`l_pkcl01()`](https://pharmaverse.github.io/aNCA/reference/l_pkcl01.md)
  : Create PK Concentration Listing

- [`lambda_slope_plot()`](https://pharmaverse.github.io/aNCA/reference/lambda_slope_plot.md)
  : Generate a Lambda Slope Plot

- [`metadata_nca_parameters`](https://pharmaverse.github.io/aNCA/reference/metadata_nca_parameters.md)
  : metadata_nca_parameters

- [`metadata_nca_variables`](https://pharmaverse.github.io/aNCA/reference/metadata_nca_variables.md)
  : metadata_nca_variables

- [`multiple_matrix_ratios()`](https://pharmaverse.github.io/aNCA/reference/multiple_matrix_ratios.md)
  : Calculate Matrix Ratios This function calculates the ratios for a
  given data set, based on the shared time points for each matrix
  concentration sample. The user can input multiple tissues for which
  ratios should be calculated.

- [`parse_annotation()`](https://pharmaverse.github.io/aNCA/reference/parse_annotation.md)
  : Parses annotations in the context of data. Special characters and
  syntax are substituted by actual data and/or substituted for format
  that is better parsed via rendering functions (e.g. plotly).

- [`pivot_wider_pknca_results()`](https://pharmaverse.github.io/aNCA/reference/pivot_wider_pknca_results.md)
  : Reshape PKNCA Results

- [`pk.calc.volpk()`](https://pharmaverse.github.io/aNCA/reference/pk.calc.volpk.md)
  : Calculate the total urine volume

- [`pk_dose_qc_plot()`](https://pharmaverse.github.io/aNCA/reference/pk_dose_qc_plot.md)
  : Create a PK Dose Quality Control (QC) Plot

- [`pkcg01()`](https://pharmaverse.github.io/aNCA/reference/pkcg01.md) :
  Generate PK Concentration-Time Profile Plots

- [`pkcg02()`](https://pharmaverse.github.io/aNCA/reference/pkcg02.md) :
  Generate Combined PK Concentration-Time Profile Plot by Cohort

- [`pknca_calculate_f()`](https://pharmaverse.github.io/aNCA/reference/pknca_calculate_f.md)
  : Calculate bioavailability for intravascular vs extravascular aucs

- [`prepare_plot_data()`](https://pharmaverse.github.io/aNCA/reference/prepare_plot_data.md)
  : Prepare Data for PK Dose QC Plotting

- [`preprocess_data_for_plot()`](https://pharmaverse.github.io/aNCA/reference/preprocess_data_for_plot.md)
  : Prepare Data for PK Lineplot

- [`read_pk()`](https://pharmaverse.github.io/aNCA/reference/read_pk.md)
  : Reads PK datasets from various file formats.

- [`run_app()`](https://pharmaverse.github.io/aNCA/reference/run_app.md)
  : Run the Shiny app

- [`select_minimal_grouping_cols()`](https://pharmaverse.github.io/aNCA/reference/select_minimal_grouping_cols.md)
  : Find Minimal Grouping Columns for Strata Reconstruction

- [`simplify_unit()`](https://pharmaverse.github.io/aNCA/reference/simplify_unit.md)
  : Simplify compound unit expressions

- [`translate_terms()`](https://pharmaverse.github.io/aNCA/reference/translate_terms.md)
  : Translate Terms from One Nomenclature to Another

- [`validate_pk()`](https://pharmaverse.github.io/aNCA/reference/validate_pk.md)
  : Validates data table with raw pk data.

- [`verify_parameters()`](https://pharmaverse.github.io/aNCA/reference/verify_parameters.md)
  : Conditionally Verify and Override PK Parameters Based on Sample Type

# Articles

### All vignettes

- [Adding new TLGs to the
  package](https://pharmaverse.github.io/aNCA/articles/adding_tlg.md):

  Learn how to add a new TLG to the package.

- [aNCA Shiny App User
  Guide](https://pharmaverse.github.io/aNCA/articles/aNCA.md):

  Learn how to get started with the basics of aNCA Shiny application.

- [Contributing to
  aNCA](https://pharmaverse.github.io/aNCA/articles/contributing.md):

  Learn how to contribute to the development of the aNCA package
